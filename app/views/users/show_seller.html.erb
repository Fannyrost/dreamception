<%= render 'shared/navbar' %>

<div class="container show-user">

  <div class= "d-flex justify-content-between align-items-center">
    <div class=""><h1>Mon profil</h1></div>
    <div class="">Modifier</div>
  </div>
  <div class="box-profil d-flex justify-content-between">
    <div class="">
      <p>Nom : <%= @user.last_name %></p>
      <p>Prénom : <%= @user.first_name %></p>
    </div>
    <div class="">
      <p>Email : <%= @user.email %></p>
      <p>Téléphone : <%= @user.phone_number %></p>
    </div>
  </div>


  <div class="mt-3"><h1> Historique Vendeur - passées </h1></div>
  <% @user.experiences.each do |experience| %>
    <% experience.bookings.past_bookings.each do |booking| %>
      <div class="box-exp">
        <h1><%= booking.experience.title %></h1>
        <p><%= booking.experience.short_description %> <%= booking.experience.average_rating %></p>
        <p><%= booking.experience.average_rating %></p>
        <p><strong>Informations client </strong></p>
        <p>Nom et prénom : <%= booking.user.last_name %> <%= booking.user.first_name %></p>
        <p>Email : <%= booking.user.email %></p>
        <p>Téléphone : <%= booking.user.phone_number %></p>
        <div class="d-flex">
<!-- comment récupérer le rating ??? -->
          <% if booking.experience.average_rating != nil %>
            <% n = booking.experience.average_rating.truncate() %>
            <% n.times do %>
              <div><p><span  class="stars"><i class="fas fa-star"></i></span></p></div>
            <% end %>
            <% (5-n).times do %>
              <div><p><span  class="stars"><i class="far fa-star"></i></span></p></div>
            <% end %>
          <% end %>
        </div>
      </div>
    <% end %>
  <% end %>


  <div class="mt-3"><h1> Historique Vendeur - à venir</h1></div>
  <% @user.experiences.each do |experience| %>
    <% experience.bookings.next_bookings.each do |booking| %>
      <div class="box-exp">
        <h1><%= booking.experience.title %></h1>
        <p><%= booking.experience.short_description %> <%= booking.experience.average_rating %></p>
        <p><%= booking.experience.average_rating %></p>
        <p><strong>Informations client </strong></p>
        <p>Nom et prénom : <%= booking.user.last_name %> <%= booking.user.first_name %></p>
        <p>Email : <%= booking.user.email %></p>
        <p>Téléphone : <%= booking.user.phone_number %></p>
      </div>
    <% end %>
  <% end %>


  <div class="box-past-exp"><h1>Historique client - passées</h1>
    <% @user.bookings.past_bookings.each do |booking| %>
      <div class="box-exp">
        <h1> <%= booking.experience.title %></h1>
        <p> <%= booking.experience.short_description %> </p>
        <div class="d-flex">
          <% if booking.experience.average_rating != nil %>
            <% n = booking.experience.average_rating.truncate() %>
            <% n.times do %>
              <div><p><span  class="stars"><i class="fas fa-star"></i></span></p></div>
            <% end %>
            <% (5-n).times do %>
              <div><p><span  class="stars"><i class="far fa-star"></i></span></p></div>
            <% end %>
          <% end %>
        </div>
      </div>
    <% end %>
  </div>

  <div class="box-next-exp"><h1>Historique client - à venir</h1>
    <% @user.bookings.next_bookings.each do |booking| %>
      <div class="box-exp">
        <h1> <%= booking.experience.title %></h1>
        <p> <%= booking.experience.short_description %></p>
        <p> <%= booking.experience.average_rating %></p>
      </div>
    <% end %>
  </div>


</div>
